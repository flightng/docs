# 滤波器配置

本指南介绍如何配置 Fydelix 的滤波器系统。

---

## 为什么需要滤波？

滤波器用于去除陀螺仪信号中的噪声，同时保留有用的飞行数据。

**噪声来源**：

- 电机振动
- 螺旋桨共振
- 机架振动
- 传感器噪声

---

## 滤波器参数

### 陀螺仪滤波器

| 参数 | 说明 | 默认值 | 范围 |
|------|------|--------|------|
| `GYRO_LPF_CUTOFF` | 低通截止频率 (Hz) | 100 | 50-500 |

### D项滤波器

| 参数 | 说明 | 默认值 | 范围 |
|------|------|--------|------|
| `D_TERM_LPF_CUTOFF` | 低通截止频率 (Hz) | 80 | 40-300 |

---

## 滤波器调优

### 平衡点

滤波器调优是在**噪声抑制**和**响应延迟**之间寻找平衡：

| 方向 | 截止频率 | 效果 |
|------|----------|------|
| 强滤波 | 低 | 噪声少，延迟高 |
| 弱滤波 | 高 | 噪声多，延迟低 |

### 调优步骤

1. **从默认值开始**
2. **评估噪声**：电机发热？降低截止频率
3. **评估延迟**：响应迟钝？提高截止频率
4. **保存设置**

---

## 常见配置

### 标准配置（推荐）

```
param set GYRO_LPF_CUTOFF 100
param set D_TERM_LPF_CUTOFF 80
param save
```

### 低延迟配置（竞速）

```
param set GYRO_LPF_CUTOFF 150
param set D_TERM_LPF_CUTOFF 100
param save
```

!!! warning "注意"
    更高的截止频率会允许更多噪声通过，可能导致电机发热。

### 高噪声环境

```
param set GYRO_LPF_CUTOFF 80
param set D_TERM_LPF_CUTOFF 60
param save
```

---

## 推荐设置参考

| 机型 | GYRO_LPF | D_TERM_LPF |
|------|----------|------------|
| 5寸自由式 | 100 | 80 |
| 5寸竞速 | 120-150 | 90-100 |
| 3寸机 | 90 | 70 |
| Tiny Whoop | 80 | 60 |

---

## 故障排除

??? question "电机过热"
    降低 D 项滤波器截止频率：
    ```
    param set D_TERM_LPF_CUTOFF 60
    ```

??? question "响应延迟"
    提高滤波器截止频率：
    ```
    param set GYRO_LPF_CUTOFF 120
    ```

??? question "悬停时抖动"
    降低陀螺仪滤波器截止频率：
    ```
    param set GYRO_LPF_CUTOFF 80
    ```

